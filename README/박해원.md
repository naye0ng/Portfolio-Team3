# Hello Universe : ë°•í•´ì›(ğŸŒâ˜ï¸)

ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ë˜ì˜¤ë˜ í–‰ë³µí•˜ê²Œ ì‚´ê³ ì‹¶ì€ ê°œë°œì ì›Œë„ˆë¹„ ë°•í•´ì›ì…ë‹ˆë‹¤><


## 1ì°¨ ê°œë°œì¼ì§€



**ê¸°ê°„ : 2019.07.08 ~ 2019.07.19**

<br/>

#### 1. ì†Œì…œ ë¡œê·¸ì¸ êµ¬í˜„

- https://firebase.google.com/docs/auth ë¥¼ ì°¸ê³ í•˜ì—¬, Facebook, Github, Google ë¡œê·¸ì¸ì„ êµ¬í˜„í•˜ì˜€ë‹¤.

- íƒ­ì„ ë‹«ìœ¼ë©´ ë¡œê·¸ ì•„ì›ƒì´ ë˜ë„ë¡ êµ¬í˜„í•˜ê¸° ìœ„í•´ firebase.auth().setPersistenceì—ì„œ SESSIONìœ¼ë¡œ íŒŒë¼ë¯¸í„°ë¥¼ ì„¤ì •í•˜ì˜€ê³ , ì†Œì…œ ì¢…ë¥˜ê°€ ë‹¤ë¥´ë”ë¼ë„ ê°™ì€ ì´ë©”ì¼(googleì—ì„œ aaa@google.comê³¼ githubì—ì„œ aaa@google.com)ìœ¼ë¡œ ì¤‘ë³µ ë¡œê·¸ì¸ì´ ë¶ˆê°€ëŠ¥ í•˜ë„ë¡ ì—ëŸ¬ ì²˜ë¦¬ë¥¼ í–ˆë‹¤.

```javascript
firebase.auth().setPersistence(firebase.auth.Auth.Persistence.SESSION)
// ì„¸ì…˜ (íƒ­)ì´ ì‚´ì•„ìˆì„ ë•Œê¹Œì§€ ë¡œê·¸ì¸ì„ ìœ ì§€í•œë‹¤
    .then(function () {
    let provider = new firebase.auth.FacebookAuthProvider() // í˜ì´ìŠ¤ë¶ ë¡œê·¸ì¸
    return firebase.auth().signInWithPopup(provider) // íŒì—…ì„ ë„ì›Œì„œ ë¡œê·¸ì¸ í•˜ë„ë¡ í•¨
        .catch(function (error) {
        if (error.code === 'auth/account-exists-with-different-credential') 
            // ì¤‘ë³µ íšŒì›ê°€ì…ì˜ ê²½ìš°
        {
            Swal.fire({
                text: "ì´ë¯¸ í•´ë‹¹ ì´ë©”ì¼ê³¼ ì—°ë™ëœ ê³„ì •ì´ ìˆìŠµë‹ˆë‹¤.",
                type: 'warning'
            })
        }
        else{
            Swal.fire({
                text: error.message,
                type: 'warning'
            })
        }
    })
})
```


#### 2. í”„ë¡œí•„ í˜ì´ì§€ êµ¬í˜„

- Userì˜ ì •ë³´ë“¤ (ì†Œì…œ ë¡œê·¸ì¸ì—ì„œ ë°›ì•„ì˜¤ëŠ” ì´ë¦„, ì´ë©”ì¼, ì‚¬ì§„, ì „í™”ë²ˆí˜¸) ì •ë³´ë¥¼ ë³´ì—¬ì£¼ëŠ” í”„ë¡œí•„ í˜ì´ì§€ë¥¼ ë§Œë“¤ì—ˆë‹¤.

- ë¡œê·¸ì¸ì„ í–ˆì„ ë•Œ, Headerì— ë‚˜ì˜ ì‚¬ì§„ ì•„ì´ì½˜ì„ ë³´ì—¬ì£¼ì–´, í´ë¦­í•˜ë©´ ë¡œê·¸ì•„ì›ƒ/í”„ë¡œí•„ í˜ì´ì§€ë¡œ ì´ë™í•  ìˆ˜ ìˆë„ë¡ drawerë¥¼ ë§Œë“¤ì–´ ì£¼ì—ˆë‹¤.

- ìƒˆë¡œê³ ì¹¨ í–ˆì„ ë•Œ, user ì˜ ìƒíƒœë¥¼ ì²´í¬ í•˜ëŠ” ë¶€ë¶„ì„ êµ¬í˜„í•˜ëŠ”ë° ì‹ ê²½ì¼ë‹¤. ì´ ë¶€ë¶„ì€ vuexë¥¼ ì‚¬ìš©í•˜ì—¬, ì–´ë–¤ vue í˜ì´ì§€ê°€ ë¡œë“œ ë ë•Œë§ˆë‹¤ mounted() ë¶€ë¶„ì— vuexì— ìˆëŠ” action ì¤‘ í•˜ë‚˜ì¸ "checkUserStatus"ë¥¼ ë¶ˆëŸ¬ì£¼ì–´, store ì— ìˆëŠ” userë¥¼ ê³„ì† ì—…ë°ì´íŠ¸ í•´ì£¼ì—ˆë‹¤.

```javascript
checkUserStatus({commit,state}){
    // User ìƒíƒœ ê³„ì† í™•ì¸í•´ì„œ, ìœ ì € ì—…ë°ì´íŠ¸ í•´ì£¼ê¸°
    return new Promise((resolve, reject) => {
      firebase.auth().onAuthStateChanged((user) => { // user ìƒíƒœ listener
        if (user) { // ë§Œì•½ í˜„ì¬ userê°€ ë¡œê·¸ì¸ ëœ ìƒíƒœë¼ë©´,
          commit('SET_USER', user); // store.js ì— ìˆëŠ” userë¥¼ ì—…ë°ì´íŠ¸ í•´ì¤€ë‹¤.
          resolve(user);
        }
      });
    });
  },
```

#### 3. ì¼ë°˜ ì´ë©”ì¼ ë¡œê·¸ì¸ê³¼ ì†Œì…œ ë¡œê·¸ì¸ ì—°ë™ êµ¬í˜„

- ì´ë©”ì¼ë¡œ ì¼ë°˜ íšŒì›ê°€ì…ì„ í–ˆì„ ê²½ìš°, í”„ë¡œí•„ í˜ì´ì§€ì—ì„œ sns ê³„ì •ê³¼ ì—°ë™ í•  ìˆ˜ ìˆëŠ” ì˜µì…˜ì„ ì œê³µí•´ì£¼ì—ˆë‹¤.

- ì—¬ê¸°ì„œë„ ì¤‘ë³µ íšŒì›ê°€ì…ì„ ë°©ì§€í•˜ì—¬ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ì˜€ë‹¤.


```javascript
LinkSNS(num) {
    var provider = new firebase.auth.GoogleAuthProvider(); // googleë¡œ ì—°ë™ í•  ê²½ã…‡
    
    return firebase.auth().currentUser.linkWithPopup(provider).then(function (result) {
        // linkWithPopup í•¨ìˆ˜ë¥¼ ì‚¬ìš©
      var credential = result.credential;
      var user = result.user;
      return user
    }).catch(function (error) {
      var errorCode = error.code;
      if (errorCode === 'auth/email-already-in-use') {
        Swal.fire({
          text: 'ì´ë¯¸ ë‹¤ë¥¸ ì´ë©”ì¼ì— ì—°ê²°ëœ ê³„ì •ì…ë‹ˆë‹¤',
          type: 'warning'
        })
      }
      else if (errorCode === 'auth/credential-already-in-use') {
        Swal.fire({
          text: 'ì´ë¯¸ SNS ë¡œê·¸ì¸ì— ë“±ë¡ëœ ê³„ì •ì…ë‹ˆë‹¤',
          type: 'warning'
        })
      }
    });
  }
```


## 2ì°¨ ê°œë°œì¼ì§€


**ê¸°ê°„ : 2019.07.22 ~ 2019.08.16**


#### 1. í¬íŠ¸í´ë¦¬ì˜¤ ë° í¬ìŠ¤íŠ¸ ì¢‹ì•„ìš” êµ¬í˜„

- ëŒ“ê¸€ì„ ë‹¤ëŠ” ê²ƒì—ì„œ ë” ë‚˜ì•„ê°€, ì¢‹ì•„ìš” ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ì˜€ë‹¤.

- Portfolio, post collection ì•ˆì— likeListë¼ëŠ” collectionì„ ì¶”ê°€í•˜ì˜€ë‹¤. í•´ë‹¹ ìœ ì €ê°€ í•´ë‹¹ ê²Œì‹œë¬¼ì„ ì¢‹ì•„ìš” ëˆŒë €ì„ ê²½ìš°, ê·¸ likeList ì•ˆì— í•´ë‹¹ ìœ ì € ì´ë©”ì¼ì„ ì¶”ê°€í•˜ì˜€ë‹¤.

- ê²Œì‹œë¬¼ì˜ detail í˜ì´ì§€ì— ë“¤ì–´ê°€ë©´, mounted()ì— í•´ë‹¹ ê²Œì‹œë¬¼ì˜ ì¢‹ì•„ìš” ê°œìˆ˜, ì¢‹ì•„ìš” ëˆ„ë¥´ ì‚¬ëŒë“¤ì˜ ë¦¬ìŠ¤íŠ¸, í˜„ì¬ ë¡œê·¸ì¸ í•œ ìœ ì €ê°€ í•´ë‹¹ ê²Œì‹œë¬¼ì„ ì¢‹ì•„ìš” í–ˆëŠ”ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.


```javascript
async getLikers(){
  const list = await FirebaseService.getPortLikers(this.port.id);
  // ìš°ì„  í•´ë‹¹ ê²Œì‹œë¬¼ì˜ ì¢‹ì•„ìš” ë¦¬ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
  this.likers = [];
  list.forEach(l=>{
    // ê°ê°ì˜ ì¢‹ì•„ìš” ìœ ì €ë“¤ì— ëŒ€í•œ ë‹‰ë„¤ì„ê³¼ í”„ë¡œí•„ ì‚¬ì§„ì„ ê°€ì ¸ì˜¨ë‹¤.
    firebase.database().ref("user").child(l.user.split('@')[0]).once("value")
    .then(snapshot => {
      this.likers.push({'nickname': snapshot.val().nickname,
                        'avatar': snapshot.val().photoURL});
    })
  })
}
```

#### 2. í¬ìŠ¤íŠ¸ì— tagì™€ ê²€ìƒ‰ ê¸°ëŠ¥ ì¶”ê°€

- Postë¼ëŠ” ì»¬ë™ì…˜ì— parameter ì¤‘ tagë¼ëŠ” arrayë¥¼ í•˜ë‚˜ ë§Œë“¤ì—ˆë‹¤.
- postë¥¼ í•˜ë‚˜ ì‘ì„±í•  ë•Œ ë§ˆë‹¤, ìµœëŒ€ 3ê°œì˜ tagë¥¼ ë‹¬ ìˆ˜ ìˆë‹¤. tagë¥¼ ë‹¬ë©´, tagë¼ëŠ” collectionì—ì„œ í•´ë‹¹ tag ê°’ì´ ìˆëŠ”ì§€ ê²€ìƒ‰í•œë‹¤. ë§Œì•½ ìˆë‹¤ë©´, ê·¸ tag ì•ˆì— ìˆëŠ” collectionì¸ postlistì— í•´ë‹¹ post ê²Œì‹œë¬¼ idë¥¼ ë„£ì–´ì¤€ë‹¤.

```javascript
tag.forEach(async tagg => {
    let curtag = firestore.collection(TAGS).doc(tagg)
    var temp = tagg
    const doc = await curtag.get()
    if (doc.exists){
        // ë§Œì•½ ê²Œì‹œë¬¼ì„ ì‘ì„±í•  ë•Œ tagê°€ ì´ë¯¸ ìˆëŠ” tagë¼ë©´
        var data = doc.data();
        data.postlist = data.postlist.concat([id]);
        firestore.collection(TAGS).doc(temp).set({
            postlist : data.postlist
        })
    }
    else{
        // ì•„ì˜ˆ ìƒˆë¡œìš´ tagë¼ë©´, tagë¥¼ í•˜ë‚˜ ë§Œë“¤ì–´ì„œ tag ì»¬ë ‰ì…˜ì— ì¶”ê°€í•´ì¤€ë‹¤.
        firestore.collection(TAGS).doc(temp).set({
            postlist : [id]
        })
    }
})
```

- íƒœê·¸ ê²€ìƒ‰ì€, ëª¨ë“  tag collection ì— ìˆëŠ” íƒœê·¸ë¥¼ ë°°ì—´ë¡œ ë¶ˆëŸ¬ì™”ê³ , í˜„ì¬ ê²€ìƒ‰ì°½ì— ìˆëŠ” ë‹¨ì–´ê°€ tagì— í¬í•¨ë˜ì–´ ìˆë‹¤ë©´, (includes í•¨ìˆ˜ ì‚¬ìš©), í•´ë‹¹ tag collectionì— ìˆëŠ” ê²Œì‹œë¬¼ë“¤ì„ ë„ì›Œì¤€ë‹¤.

```javascript
var FilterTag = await this.tags.filter(tag=>{
    return tag.id.includes(newVal)
    // tag ëª©ë¡ì—ì„œ í˜„ì¬ ê²€ìƒ‰ì–´ê°€ í¬í•¨ëœ tagë“¤ì„ í•„í„°ë§ í•´ì¤€ë‹¤.
})
if (FilterTag){
    var temppost = [];
    await this.asyncForEach(FilterTag, async (tagg) => {
        temppost = temppost.concat(tagg.postlist);
        // ê°ê°ì˜ tag ë§ˆë‹¤ í¬í•¨ëœ ê²Œì‹œë¬¼ë“¤ì„ temppostì— ì¶”ê°€í•´ì¤€ë‹¤.
    });
    temppost = [...new Set(temppost)];
    // ì¤‘ë³µëœ ê²Œì‹œë¬¼ì¼ ì¡´ì¬í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, setë¡œ ë§Œë“¤ì–´ ì¤€ë‹¤.
    var templist = []
    await this.asyncForEach(temppost, async (post) => {
        templist.push(await FirebaseService.getPost(post));
    })
    // firebaseserviceì—ì„œ ê°ê°ì˜ ê²Œì‹œë¬¼ ì•„ì´ë””ë¥¼ ë„˜ê²¨ì£¼ì–´, ê°ê° ê²Œì‹œë¬¼ì˜ ìƒì„¸ì •ë³´ë¥¼ ë°›ì•„ì˜¨ë‹¤.
    this.posts = templist;
}
else{
    this.posts = [];
}
```

#### 3. í”„ë¡œí•„ í˜ì´ì§€ ê¸°ëŠ¥ ì¶”ê°€

- í”„ë¡œí•„ í˜ì´ì§€ì—ì„œ, í¬ê²Œ ë‚´ê°€ ì¢‹ì•„ìš” í•œ ê²Œì‹œë¬¼ë“¤/ ë‚´ê°€ ì‘ì„±í•œ ê²Œì‹œë¬¼ë“¤ì„ í•œë²ˆì— ëª¨ì•„ì„œ ë³´ì—¬ì£¼ëŠ” ì¶”ê°€ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ì˜€ë‹¤.

```javascript
async getUserPortfolios(){
    await this.portfolioss.filter(port=>{
        // ìš°ì„ , ì „ì²´ portfolioì—ì„œ,
        return FirebaseService.getPortLikers(port.id).then(likers=>{
            // í•´ë‹¹ portfolioì˜ ì¢‹ì•„ìš” ë¦¬ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì˜¨ ë‹¤ìŒ,
            for(var i=0;i<likers.length; i++){
                if (likers[i].user==this.useremail){
                    // ë§Œì•½ í•´ë‹¹ ì¢‹ì•„ìš” ë¦¬ìŠ¤íŠ¸ì— í•´ë‹¹ ìœ ì €ê°€ ì†í•´ìˆëŠ” ê²½ìš°, 
                    // ì¢‹ì•„ìš” í•œ ê²Œì‹œë¬¼ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•´ì£¼ì—ˆë‹¤.
                    this.userports.push(port);
                    break;
                }
            }
        })
    })
```

#### 4. intro page ì— ìŒì•… bgm êµ¬í˜„

- chromeì€ ìŒì•… ìë™ì¬ìƒì„ ë§‰ì•˜ì§€ë§Œ, ì–´ë–¤ ìœ ì €ì˜ ë™ì‘ (í´ë¦­ê³¼ ê°™ì€)ì´ ìˆì„ ê²½ìš°, ìë™ ì¬ìƒì´ ê°€ëŠ¥í•˜ê²Œ í•´ ë†“ì•˜ë‹¤.

```html
<audio id="soprano" autoplay loop>
<!--ì²˜ìŒ landing í–ˆì„ ë•Œ ë‚˜ì˜¤ëŠ” ìŒì› -->
    <source src="@/assets/intro_with_long_soprano.mp3" />
</audio>
<audio id="HU">
<!--sunì´ë¼ëŠ” elementë¥¼ í´ë¦­ í–ˆì„ ë•Œ ë‚˜ì˜¤ëŠ” ìŒì› -->
    <source src="@/assets/intro_with_long_HU.mp3" />
</audio>
```

```javascript
var x = document.getElementById("HU"); // ìŒì›1
var y = document.getElementById("soprano"); // ìŒì› 2
sun.addEventListener("click", function() { // í´ë¦­í–ˆì„ë•Œì˜ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      y.autoplay=false;
      x.autoplay = true; // ìŒì›1ì€ ë„ê³ , ìŒì›2ë¥¼ ì¼ ë‹¤
      y.load();
      x.load();
}
```

#### 5. íšŒì›ê°€ì…ì‹œ SNS ì´ë¯¸ì§€, ëœë¤ í”„ë¡œí•„ ì´ë¯¸ì§€ ì§ì ‘ ì„¤ì •í•˜ê¸°

- realtime databaseì— ìˆëŠ” userì˜ ì •ë³´ ì¤‘, photourl ê°’ì„ ì„¤ì •í•˜ì˜€ë‹¤.
- í”„ë¡œí•„ ìˆ˜ì •ì— ê°€ë©´, ì´ë¯¸ì§€ë¥¼ ì§ì ‘ ì—…ë¡œë“œ í•˜ë©´, firestorageì— ë„£ì–´ ì£¼ê³  í•´ë‹¹ urlì„ ë°›ì•„ì„œ user ê°ì²´ì˜ photourlì— ë„£ì–´ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•˜ì˜€ë‹¤.

```javascript
async profilePhotoUploader(email, key, img) {
    
    var ref = firebase.storage().ref();
    
    // Image name setting
    var name = email;

    // Upload image to firestorage
    var uploadTask = ref.child('profile/' + name).putString(img, 'data_url');
    await uploadTask.on(firebase.storage.TaskEvent.STATE_CHANGED, // or 'state_changed'
    function(snapshot) {
      var progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
    } , function() {
      // firestorage ì—ì„œë¶€í„°ì˜ í•´ë‹¹ ì´ë¯¸ì§€ urlì„ ê°€ì ¸ì˜¨ë‹¤
      uploadTask.snapshot.ref.getDownloadURL().then(function(storageOutputUrl) {
       firebase.database().ref("user").child(key).child('photoURL').set(storageOutputUrl)
          // í•´ë‹¹ ì´ë¯¸ì§€ urlì„ ìœ ì €ì˜ photoURL columnì— ë„£ì–´ì¤€ë‹¤.
      })
    })
  },
```

